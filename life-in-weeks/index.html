---
layout: default
title: Life In Weeks
---

<style>
  .liw-container {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    padding: 0 1rem;
    box-sizing: border-box;
  }

  .liw-header {
    text-align: center;
    margin-bottom: 1rem;
  }

  .liw-header h1 {
    margin-bottom: 0.25rem;
  }

  .liw-header p {
    color: #666;
    margin-top: 0;
  }

  .liw-legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1rem;
    font-size: 0.8rem;
  }

  .liw-legend-item {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  .liw-legend-swatch {
    display: inline-block;
    width: 14px;
    height: 14px;
    border-radius: 3px;
    flex-shrink: 0;
  }

  .liw-grid {
    margin: 0 auto;
    overflow-x: auto;
  }

  .liw-row {
    display: flex;
    align-items: center;
    padding: 1px 4px;
  }

  .liw-year-label {
    width: 42px;
    font-size: 0.75rem;
    color: #888;
    text-align: right;
    padding-right: 8px;
    flex-shrink: 0;
    font-variant-numeric: tabular-nums;
    font-weight: 600;
  }

  .liw-row-boxes {
    display: flex;
    gap: 2px;
  }

  .liw-box {
    position: relative;
    width: 18px;
    height: 18px;
    border-radius: 3px;
    border: 2px solid #ccc;
    background: #f5f5f5;
    cursor: default;
    flex-shrink: 0;
  }

  .liw-box.liw-future {
    opacity: 0.25;
  }

  /* Hover tooltip (date + age detail) */
  .liw-box .liw-tip {
    display: none;
    position: absolute;
    bottom: calc(100% + 6px);
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: #fff;
    font-size: 0.7rem;
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    z-index: 30;
    pointer-events: none;
  }

  .liw-box:hover .liw-tip,
  .liw-box:focus .liw-tip {
    display: block;
  }

  .liw-box.liw-future .liw-tip {
    display: none !important;
  }

  /* Always-visible event label */
  .liw-event-label {
    position: absolute;
    left: calc(100% + 4px);
    top: 50%;
    transform: translateY(-50%);
    font-size: 0.7rem;
    line-height: 1;
    white-space: nowrap;
    color: #444;
    background: rgba(255, 255, 255, 0.92);
    padding: 2px 5px;
    border-radius: 3px;
    z-index: 10;
    pointer-events: none;
  }

  .liw-future .liw-event-label {
    opacity: 0.5;
  }

  /* Decade background bands */
  .liw-row[data-decade="0"] { background-color: #eef3fb; }
  .liw-row[data-decade="1"] { background-color: #eefbf3; }
  .liw-row[data-decade="2"] { background-color: #fdf6ee; }
  .liw-row[data-decade="3"] { background-color: #f5eefb; }
  .liw-row[data-decade="4"] { background-color: #eefbfb; }
  .liw-row[data-decade="5"] { background-color: #fbeef0; }
  .liw-row[data-decade="6"] { background-color: #f0f2f4; }
  .liw-row[data-decade="7"] { background-color: #fbf9ee; }
  .liw-row[data-decade="8"] { background-color: #f1eefb; }
  .liw-row[data-decade="9"] { background-color: #eef4f1; }

  @media (max-width: 900px) {
    .liw-box {
      width: 12px;
      height: 12px;
      border-width: 1.5px;
      border-radius: 2px;
    }
    .liw-year-label {
      width: 34px;
      font-size: 0.65rem;
      padding-right: 5px;
    }
    .liw-row-boxes {
      gap: 1.5px;
    }
    .liw-event-label {
      font-size: 0.6rem;
    }
  }

  @media (max-width: 600px) {
    .liw-box {
      width: 8px;
      height: 8px;
      border-width: 1px;
      border-radius: 1px;
    }
    .liw-year-label {
      width: 28px;
      font-size: 0.5rem;
      padding-right: 3px;
    }
    .liw-row-boxes {
      gap: 1px;
    }
    .liw-legend {
      gap: 0.5rem;
      font-size: 0.7rem;
    }
    .liw-event-label {
      font-size: 0.5rem;
      padding: 1px 3px;
    }
  }
</style>

<div class="liw-container">
  <div class="liw-header">
    <h1>Life In Weeks</h1>
    <p>Each box is one week. Border color = location. Fill color = activity.</p>
  </div>

  {% assign liw = site.data.life-in-weeks %}
  <div class="liw-legend">
    {% for item in liw.legend %}
    <span class="liw-legend-item">
      <span class="liw-legend-swatch" style="border: 2px solid {{ liw.locations[item.location] }}; background: {{ liw.activities[item.activity] }};"></span>
      {{ item.label }}
    </span>
    {% endfor %}
    <span class="liw-legend-item">
      <span class="liw-legend-swatch" style="border: 2px solid #ccc; background: #f5f5f5; opacity: 0.3;"></span>
      Future
    </span>
  </div>

  <div class="liw-grid" id="grid"></div>
</div>

<script>
(function () {
  {% assign liw = site.data.life-in-weeks %}
  var CONFIG = {{ liw | jsonify }};

  var birthParts = CONFIG.birthday.split('-');
  var BIRTH = new Date(parseInt(birthParts[0], 10), parseInt(birthParts[1], 10) - 1, parseInt(birthParts[2], 10));
  var LIFESPAN = CONFIG.lifespan_years;
  var MS_PER_WEEK = 7 * 24 * 60 * 60 * 1000;
  var WEEKS_PER_ROW = 52;
  var NOW = new Date();

  var LOC_COLORS = CONFIG.locations;
  var ACT_COLORS = CONFIG.activities;
  var EVENTS = CONFIG.events;

  function parseDate(s) {
    var parts = s.split('-');
    return new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, parseInt(parts[2], 10));
  }

  var eventsByWeek = {};
  EVENTS.forEach(function (evt) {
    var d = parseDate(evt.date);
    var weekIdx = Math.floor((d - BIRTH) / MS_PER_WEEK);
    if (!eventsByWeek[weekIdx]) eventsByWeek[weekIdx] = [];
    eventsByWeek[weekIdx].push(evt);
  });

  var MONTHS = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  function fmtDate(d) {
    return MONTHS[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear();
  }

  function ageStr(d) {
    var years = d.getFullYear() - BIRTH.getFullYear();
    var m = d.getMonth() - BIRTH.getMonth();
    if (m < 0 || (m === 0 && d.getDate() < BIRTH.getDate())) years--;
    return 'Age ' + years;
  }

  var gridEl = document.getElementById('grid');
  var currentBased = EVENTS[0].based;
  var currentDoing = EVENTS[0].doing;

  for (var yearIdx = 0; yearIdx < LIFESPAN; yearIdx++) {
    var decade = Math.floor(yearIdx / 10);
    var calendarYear = BIRTH.getFullYear() + yearIdx;

    var row = document.createElement('div');
    row.className = 'liw-row';
    row.setAttribute('data-decade', decade);

    var label = document.createElement('span');
    label.className = 'liw-year-label';
    if (yearIdx % 5 === 0) {
      label.textContent = calendarYear;
    }
    row.appendChild(label);

    var boxesDiv = document.createElement('div');
    boxesDiv.className = 'liw-row-boxes';

    for (var w = 0; w < WEEKS_PER_ROW; w++) {
      var globalWeek = yearIdx * WEEKS_PER_ROW + w;
      var weekStart = new Date(BIRTH.getTime() + globalWeek * MS_PER_WEEK);
      var isFuture = weekStart > NOW;

      var evtsThisWeek = eventsByWeek[globalWeek];
      if (evtsThisWeek) {
        evtsThisWeek.forEach(function (evt) {
          if (evt.based) currentBased = evt.based;
          if (evt.doing) currentDoing = evt.doing;
        });
      }

      var box = document.createElement('span');
      box.className = 'liw-box' + (isFuture ? ' liw-future' : '');
      box.style.borderColor = LOC_COLORS[currentBased] || '#ccc';
      box.style.background = ACT_COLORS[currentDoing] || '#f5f5f5';

      if (!isFuture) {
        box.setAttribute('tabindex', '0');
        var tipText = fmtDate(weekStart) + ' \u2014 ' + ageStr(weekStart);
        if (evtsThisWeek) {
          evtsThisWeek.forEach(function (evt) {
            tipText += ' \u2022 ' + evt.label;
          });
        }
        var tip = document.createElement('span');
        tip.className = 'liw-tip';
        tip.textContent = tipText;
        box.appendChild(tip);
      }

      // Always-visible event label
      if (evtsThisWeek) {
        var eventLabel = document.createElement('span');
        eventLabel.className = 'liw-event-label';
        eventLabel.textContent = evtsThisWeek.map(function (e) { return e.label; }).join(' \u00b7 ');
        box.appendChild(eventLabel);
      }

      boxesDiv.appendChild(box);
    }

    row.appendChild(boxesDiv);
    gridEl.appendChild(row);
  }
})();
</script>
