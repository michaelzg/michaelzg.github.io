---
layout: default
title: Life In Weeks
---

<style>
  .liw-container {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    box-sizing: border-box;
  }

  .liw-header {
    text-align: center;
    margin-bottom: 1rem;
  }

  .liw-header h1 {
    margin-bottom: 0.25rem;
  }

  .liw-header p {
    color: #666;
    margin-top: 0;
  }

  .liw-legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 1rem;
    font-size: 0.8rem;
  }

  .liw-legend-item {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  .liw-legend-swatch {
    display: inline-block;
    width: 14px;
    height: 14px;
    border-radius: 3px;
    flex-shrink: 0;
  }

  /* Match original: 60% viewport width, centered */
  .liw-grid {
    margin: 0 20%;
  }

  .liw-decade {
    padding: 4px 0;
    border-radius: 5px;
    margin-bottom: 2px;
  }

  /* Each row is its own flex container */
  .liw-flex-row {
    display: flex;
  }

  /* Base box — button reset + shared styles matching original */
  .liw-box {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    position: relative;
    height: 2em;
    max-height: 2em;
    padding: 2px 5px;
    margin: 2px 1px;
    border: 2px solid #ccc;
    border-radius: 4px;
    background: #f5f5f5;
    font-family: inherit;
    font-size: 1rem;
    color: #444;
    cursor: default;
    outline: none;
    -webkit-appearance: none;
    appearance: none;
    line-height: 1.2;
    box-sizing: border-box;
  }

  /* Empty boxes — fill available space equally (like original's w-100) */
  .liw-box:not(.liw-has-label) {
    width: 100%;
  }

  /* Labeled boxes — stay at content width */
  .liw-box.liw-has-label {
    white-space: nowrap;
    flex-shrink: 0;
  }

  .liw-box.liw-future {
    background-color: #eee !important;
    border-color: #dee2e6 !important;
  }

  /* Tooltip — below the box, matching original orange */
  .liw-box .liw-tip {
    display: none;
    position: absolute;
    top: calc(100% + 5px);
    left: 50%;
    transform: translateX(-50%);
    background: #f05d2b;
    color: #fff;
    font-size: 0.7rem;
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    z-index: 30;
    pointer-events: none;
  }

  .liw-box .liw-tip::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 5px solid transparent;
    border-bottom-color: #f05d2b;
  }

  .liw-box:hover .liw-tip,
  .liw-box:focus .liw-tip {
    display: block;
  }

  .liw-box.liw-future .liw-tip {
    display: none !important;
  }

  /* Decade background bands */
  .liw-decade[data-decade="0"] { background-color: #eef3fb; }
  .liw-decade[data-decade="1"] { background-color: #eefbf3; }
  .liw-decade[data-decade="2"] { background-color: #fdf6ee; }
  .liw-decade[data-decade="3"] { background-color: #f5eefb; }
  .liw-decade[data-decade="4"] { background-color: #eefbfb; }
  .liw-decade[data-decade="5"] { background-color: #fbeef0; }
  .liw-decade[data-decade="6"] { background-color: #f0f2f4; }
  .liw-decade[data-decade="7"] { background-color: #fbf9ee; }
  .liw-decade[data-decade="8"] { background-color: #f1eefb; }
  .liw-decade[data-decade="9"] { background-color: #eef4f1; }

  @media only screen and (max-width: 768px) {
    .liw-grid {
      margin: 0 2%;
    }
    .liw-box {
      font-size: 0.75rem;
    }
  }
</style>

<div class="liw-container">
  <div class="liw-header">
    <h1>Life In Weeks</h1>
    <p>Each box is one week. Colors are decades.</p>
  </div>

  {% assign liw = site.data.life-in-weeks %}
  <div class="liw-legend">
    {% for decade in liw.decades %}
    <span class="liw-legend-item">
      <span class="liw-legend-swatch" style="border: 2px solid {{ decade.border }}; background: {{ decade.fill }};"></span>
      {{ decade.label }}
    </span>
    {% endfor %}
    <span class="liw-legend-item">
      <span class="liw-legend-swatch" style="border: 2px solid #dee2e6; background: #eee;"></span>
      Future
    </span>
  </div>

  <div class="liw-grid" id="grid"></div>
</div>

<script>
(function () {
  {% assign liw = site.data.life-in-weeks %}
  var CONFIG = {{ liw | jsonify }};

  var birthParts = CONFIG.birthday.split('-');
  var BIRTH = new Date(parseInt(birthParts[0], 10), parseInt(birthParts[1], 10) - 1, parseInt(birthParts[2], 10));
  var LIFESPAN = CONFIG.lifespan_years;
  var MS_PER_WEEK = 7 * 24 * 60 * 60 * 1000;
  var WEEKS_PER_YEAR = 52;
  var NOW = new Date();

  var DECADES = CONFIG.decades;
  var EVENTS = CONFIG.events;

  // Row control — matching original's multipliers
  var MAX_BOXES_IN_ROW = 21;
  var BOX_END_MULT = 0.45;
  var BOX_CHAR_MULT = 0.319;

  function parseDate(s) {
    var parts = s.split('-');
    return new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, parseInt(parts[2], 10));
  }

  // Build week-index -> event(s) lookup
  var eventsByWeek = {};
  EVENTS.forEach(function (evt) {
    var d = parseDate(evt.date);
    var weekIdx = Math.floor((d - BIRTH) / MS_PER_WEEK);
    if (!eventsByWeek[weekIdx]) eventsByWeek[weekIdx] = [];
    eventsByWeek[weekIdx].push(evt);
  });

  // Auto-generate birthday events
  for (var age = 1; age < LIFESPAN; age++) {
    var bdayDate = new Date(BIRTH.getFullYear() + age, BIRTH.getMonth(), BIRTH.getDate());
    var weekIdx = Math.floor((bdayDate - BIRTH) / MS_PER_WEEK);
    var bdayEvt = {
      label: '\uD83C\uDF82 ' + age + ' in ' + (BIRTH.getFullYear() + age),
      description: 'Turned ' + age + ' year' + (age !== 1 ? 's' : '') + ' old',
      isBirthday: true
    };
    if (!eventsByWeek[weekIdx]) eventsByWeek[weekIdx] = [];
    eventsByWeek[weekIdx].unshift(bdayEvt);
  }

  var MONTHS = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  function fmtDate(d) {
    return MONTHS[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear();
  }

  function boxUnits(label) {
    if (!label) return 1;
    return 2 * BOX_END_MULT + label.length * BOX_CHAR_MULT;
  }

  var gridEl = document.getElementById('grid');

  var currentDecade = -1;
  var decadeDiv = null;
  var currentRow = null;
  var rowUnits = 0;

  function createRow() {
    currentRow = document.createElement('div');
    currentRow.className = 'liw-flex-row';
    decadeDiv.appendChild(currentRow);
    rowUnits = 0;
  }

  function ensureRowSpace(units) {
    if (rowUnits > 0 && rowUnits + units >= MAX_BOXES_IN_ROW) {
      createRow();
    }
  }

  var totalWeeks = LIFESPAN * WEEKS_PER_YEAR;

  for (var w = 0; w < totalWeeks; w++) {
    var yearOfLife = Math.floor(w / WEEKS_PER_YEAR);
    var decade = Math.floor(yearOfLife / 10);
    var weekStart = new Date(BIRTH.getTime() + w * MS_PER_WEEK);
    var isFuture = weekStart > NOW;

    // New decade section
    if (decade !== currentDecade) {
      currentDecade = decade;
      decadeDiv = document.createElement('div');
      decadeDiv.className = 'liw-decade';
      decadeDiv.setAttribute('data-decade', decade);
      gridEl.appendChild(decadeDiv);
      createRow();
    }

    var evtsThisWeek = eventsByWeek[w];
    var decadeColors = DECADES[decade] || DECADES[DECADES.length - 1];

    // Build inline label
    var boxLabel = '';
    if (evtsThisWeek) {
      boxLabel = evtsThisWeek.map(function (e) { return e.label; }).join(' \u00b7 ');
    }

    // Check row space before inserting
    var units = boxUnits(boxLabel);
    ensureRowSpace(units);

    // Create box
    var box = document.createElement('button');
    box.type = 'button';
    box.className = 'liw-box' + (isFuture ? ' liw-future' : '') + (boxLabel ? ' liw-has-label' : '');
    box.style.borderColor = decadeColors.border;
    if (!isFuture) {
      box.style.backgroundColor = decadeColors.fill;
    }

    if (boxLabel) {
      box.textContent = boxLabel;
    }

    // Tooltip
    if (!isFuture) {
      var tipText = fmtDate(weekStart) + ' \u2013 ';
      if (evtsThisWeek) {
        var descs = evtsThisWeek.map(function (e) {
          return e.description || e.label;
        });
        tipText += descs.join('; ');
      } else {
        var age = weekStart.getFullYear() - BIRTH.getFullYear();
        if (weekStart.getMonth() < BIRTH.getMonth() ||
            (weekStart.getMonth() === BIRTH.getMonth() && weekStart.getDate() < BIRTH.getDate())) {
          age--;
        }
        tipText += 'Age ' + age;
      }
      var tip = document.createElement('span');
      tip.className = 'liw-tip';
      tip.textContent = tipText;
      box.appendChild(tip);
    }

    currentRow.appendChild(box);
    rowUnits += units;

    // Break after if row is full
    if (rowUnits >= MAX_BOXES_IN_ROW) {
      createRow();
    }
  }
})();
</script>
