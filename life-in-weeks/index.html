---
layout: default
title: Life In Weeks
---

<style>
  /*
    Life In Weeks - Enhanced with Technical-Editorial Aesthetic
    Matches homepage design system
  */

  /* ========================================
     CONTAINER & LAYOUT
     ======================================== */

  .liw-container {
    width: 100vw;
    margin-left: calc(-50vw + 50%);
    box-sizing: border-box;
    animation: liw-page-fade-in 0.6s ease-out;
  }

  @keyframes liw-page-fade-in {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* ========================================
     HEADER (Condensed)
     ======================================== */

  .liw-header {
    text-align: center;
    margin-bottom: 1.25rem;
    padding-top: 0.5rem;
  }

  .liw-header h1 {
    font-family: 'JetBrains Mono', monospace;
    font-weight: 700;
    letter-spacing: 0.02em;
    margin-bottom: 0.25rem;
    color: var(--color-text-primary, #1A1A1A);
    font-size: 2.5rem;
  }

  .liw-header p {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    color: var(--color-text-secondary, #5A5A5A);
    margin-top: 0;
    font-size: 0.95rem;
  }

  /* ========================================
     LEGEND (Compact Pill Badge Style)
     ======================================== */

  .liw-legend {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 0.75rem;
    padding: 0.5rem 1rem;
  }

  .liw-legend.liw-legend-sticky {
    position: sticky;
    top: 0;
    z-index: 50;
    background: rgba(250, 248, 243, 0.95);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--color-border, #E5DED3);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    animation: liw-fade-in 0.3s ease forwards;
  }

  @keyframes liw-fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Compact pill badge styling for legend items */
  .liw-legend-item {
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.65rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    background: white;
    border: 1px solid var(--color-border, #E5DED3);
    border-radius: 10px;
    color: var(--color-text-primary, #1A1A1A);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transition: all 0.2s ease;
  }

  .liw-legend-item:hover {
    border-color: var(--color-accent, #D2691E);
    background: rgba(210, 105, 30, 0.05);
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgba(210, 105, 30, 0.15);
  }

  .liw-legend-swatch {
    display: inline-block;
    width: 10px;
    height: 10px;
    border-radius: 2px;
    flex-shrink: 0;
  }

  /* ========================================
     GRID
     ======================================== */

  .liw-grid {
    margin: 0 20%;
    padding-bottom: 3rem;
  }

  .liw-decade {
    padding: 6px 0;
    border-radius: 6px;
    margin-bottom: 4px;
  }

  .liw-flex-row {
    display: flex;
  }

  /* ========================================
     WEEK BOXES
     ======================================== */

  .liw-box {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    position: relative;
    height: 2em;
    max-height: 2em;
    padding: 2px 5px;
    margin: 2px 1px;
    border: 2px solid var(--color-border, #ccc);
    border-radius: 4px;
    background: rgba(245, 245, 245, 0.8);
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.9rem;
    color: var(--color-text-primary, #444);
    cursor: default;
    outline: none;
    -webkit-appearance: none;
    appearance: none;
    line-height: 1.2;
    box-sizing: border-box;
    transition: all 0.2s ease;
  }

  /* Hover effect on past weeks */
  .liw-box:not(.liw-future):hover {
    transform: scale(1.05);
    z-index: 100; /* Higher z-index so tooltip appears above other boxes */
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }

  .liw-box:not(.liw-has-label) {
    width: 100%;
  }

  .liw-box.liw-has-label {
    white-space: nowrap;
    flex-shrink: 0;
    font-weight: 600;
  }

  .liw-box.liw-future {
    background-color: rgba(238, 238, 238, 0.5) !important;
    border-color: var(--color-border, #dee2e6) !important;
    opacity: 0.6;
  }

  /* Current week with accent color */
  .liw-box.liw-now {
    border-color: var(--color-accent, #D2691E) !important;
    box-shadow: 0 0 0 2px var(--color-accent, #D2691E), 0 0 12px rgba(210, 105, 30, 0.4);
    z-index: 5;
    font-weight: 700;
  }

  /* ========================================
     TOOLTIPS
     ======================================== */

  .liw-box .liw-tip {
    display: none;
    position: absolute;
    top: calc(100% + 8px);
    left: 50%;
    transform: translateX(-50%);
    background: var(--color-accent, #D2691E);
    color: white;
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.7rem;
    padding: 8px 12px;
    border-radius: 6px;
    white-space: nowrap;
    z-index: 1000; /* Very high z-index to appear above everything */
    pointer-events: none;
    max-width: 300px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
  }

  .liw-tip-date {
    font-weight: 700;
    margin-bottom: 3px;
    letter-spacing: 0.02em;
  }

  .liw-tip-label {
    margin-bottom: 2px;
    opacity: 0.95;
  }

  .liw-tip-desc {
    white-space: normal;
    opacity: 0.85;
    font-style: italic;
    border-top: 1px solid rgba(255,255,255,0.3);
    padding-top: 4px;
    margin-top: 4px;
    font-size: 0.65rem;
  }

  /* Tooltip arrow */
  .liw-box .liw-tip::before {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-bottom-color: var(--color-accent, #D2691E);
  }

  .liw-box:hover .liw-tip,
  .liw-box:focus .liw-tip {
    display: block !important;
    animation: liw-tooltip-appear 0.2s ease forwards;
  }

  @keyframes liw-tooltip-appear {
    from {
      opacity: 0;
      transform: translateX(-50%) translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }
  }

  .liw-box.liw-future .liw-tip {
    display: none !important;
  }

  /* ========================================
     GO TO NOW BUTTON (Compact CTA)
     ======================================== */

  /* Wrapper to separate button from legend */
  .liw-cta-wrapper {
    text-align: center;
    margin: 0.75rem 0 1.5rem;
  }

  .liw-go-now {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.4rem;
    padding: 0.5rem 1.25rem;
    border: none;
    border-radius: 6px;
    background: var(--color-accent, #D2691E);
    color: white;
    font-size: 0.75rem;
    font-family: 'JetBrains Mono', monospace;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    -webkit-appearance: none;
    appearance: none;
    box-shadow: 0 3px 8px rgba(210, 105, 30, 0.25);
    position: relative;
    overflow: hidden;
  }

  /* Subtle pulse animation to draw attention */
  .liw-go-now::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    transform: translate(-50%, -50%) scale(0);
    transition: transform 0.6s ease;
  }

  .liw-go-now:hover::before {
    transform: translate(-50%, -50%) scale(1.5);
    opacity: 0;
  }

  .liw-go-now:hover {
    background: var(--color-accent-hover, #A0521A);
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(210, 105, 30, 0.4);
  }

  .liw-go-now:active {
    transform: translateY(-1px);
    box-shadow: 0 3px 10px rgba(210, 105, 30, 0.3);
  }

  /* Animate arrow icon */
  .liw-go-now .arrow {
    display: inline-block;
    transition: transform 0.3s ease;
  }

  .liw-go-now:hover .arrow {
    transform: translateY(3px);
    animation: bounce-arrow 0.6s ease infinite;
  }

  @keyframes bounce-arrow {
    0%, 100% { transform: translateY(3px); }
    50% { transform: translateY(6px); }
  }

  /* ========================================
     RESPONSIVE
     ======================================== */

  @media only screen and (max-width: 768px) {
    .liw-grid {
      margin: 0 2%;
    }

    .liw-box {
      font-size: 0.75rem;
    }

    .liw-header {
      margin-bottom: 0.75rem;
      padding-top: 0;
    }

    .liw-header h1 {
      font-size: 2rem;
      margin-bottom: 0.15rem;
    }

    .liw-header p {
      font-size: 0.85rem;
    }

    .liw-legend {
      gap: 0.35rem;
      padding: 0.35rem 0.5rem;
      margin-bottom: 0.5rem;
    }

    .liw-legend-item {
      font-size: 0.6rem;
      padding: 0.2rem 0.45rem;
    }

    .liw-cta-wrapper {
      margin: 0.5rem 0 1rem;
    }

    .liw-go-now {
      font-size: 0.7rem;
      padding: 0.45rem 1rem;
    }
  }
</style>

<div class="liw-container">
  <div class="liw-header">
    <h1>Life In Weeks</h1>
    <p>Each box is one week. Colors are decades.</p>
  </div>

  {% assign liw = site.data.life-in-weeks %}
  <div class="liw-legend">
    {% for decade in liw.decades %}
    <span class="liw-legend-item">
      <span class="liw-legend-swatch" style="border: 2px solid {{ decade.border }}; background: {{ decade.fill }};"></span>
      {{ decade.label }}
    </span>
    {% endfor %}
    <span class="liw-legend-item">
      <span class="liw-legend-swatch" style="border: 2px solid #dee2e6; background: #eee;"></span>
      Future
    </span>
  </div>

  <div class="liw-cta-wrapper">
    <button class="liw-go-now" id="go-now" type="button">
      <span class="arrow">↓</span> Jump to Now
    </button>
  </div>

  <div class="liw-grid" id="grid"></div>
</div>

<script>
(function () {
  {% assign liw = site.data.life-in-weeks %}
  var CONFIG = {{ liw | jsonify }};

  var birthParts = CONFIG.birthday.split('-');
  var BIRTH = new Date(parseInt(birthParts[0], 10), parseInt(birthParts[1], 10) - 1, parseInt(birthParts[2], 10));
  var LIFESPAN = CONFIG.lifespan_years;
  var MS_PER_WEEK = 7 * 24 * 60 * 60 * 1000;
  var WEEKS_PER_YEAR = 52;
  var NOW = new Date();

  var DECADES = CONFIG.decades;
  var EVENTS = CONFIG.events;

  // Row control — matching original's multipliers
  var MAX_BOXES_IN_ROW = 21;
  var BOX_END_MULT = 0.45;
  var BOX_CHAR_MULT = 0.319;

  function parseDate(s) {
    var parts = s.split('-');
    return new Date(parseInt(parts[0], 10), parseInt(parts[1], 10) - 1, parseInt(parts[2], 10));
  }

  // Build week-index -> event(s) lookup
  var eventsByWeek = {};
  EVENTS.forEach(function (evt) {
    var d = parseDate(evt.date);
    var weekIdx = Math.floor((d - BIRTH) / MS_PER_WEEK);
    if (!eventsByWeek[weekIdx]) eventsByWeek[weekIdx] = [];
    eventsByWeek[weekIdx].push(evt);
  });

  // Auto-generate birthday events
  for (var age = 1; age < LIFESPAN; age++) {
    var bdayDate = new Date(BIRTH.getFullYear() + age, BIRTH.getMonth(), BIRTH.getDate());
    var weekIdx = Math.floor((bdayDate - BIRTH) / MS_PER_WEEK);
    var bdayEvt = {
      label: '\uD83C\uDF82 ' + age + ' in ' + (BIRTH.getFullYear() + age),
      description: 'Turned ' + age + ' year' + (age !== 1 ? 's' : '') + ' old',
      isBirthday: true
    };
    if (!eventsByWeek[weekIdx]) eventsByWeek[weekIdx] = [];
    eventsByWeek[weekIdx].unshift(bdayEvt);
  }

  var MONTHS = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  function fmtDate(d) {
    return MONTHS[d.getMonth()] + ' ' + d.getDate() + ', ' + d.getFullYear();
  }

  // Count visual characters (treat each emoji/grapheme as ~2 chars width)
  function visualLength(str) {
    if (!str) return 0;
    // Use Intl.Segmenter if available for accurate grapheme counting
    if (typeof Intl !== 'undefined' && Intl.Segmenter) {
      var segmenter = new Intl.Segmenter('en', { granularity: 'grapheme' });
      var len = 0;
      for (var seg of segmenter.segment(str)) {
        // Emojis and multi-codepoint chars get extra width
        len += seg.segment.length > 1 ? 2 : 1;
      }
      return len;
    }
    // Fallback: rough heuristic using string length
    return str.length;
  }

  function boxUnits(label) {
    if (!label) return 1;
    return 2 * BOX_END_MULT + visualLength(label) * BOX_CHAR_MULT;
  }

  var gridEl = document.getElementById('grid');

  var currentDecade = -1;
  var decadeDiv = null;
  var currentRow = null;
  var rowUnits = 0;

  function createRow() {
    currentRow = document.createElement('div');
    currentRow.className = 'liw-flex-row';
    decadeDiv.appendChild(currentRow);
    rowUnits = 0;
  }

  function ensureRowSpace(units) {
    if (rowUnits > 0 && rowUnits + units >= MAX_BOXES_IN_ROW) {
      createRow();
    }
  }

  var totalWeeks = LIFESPAN * WEEKS_PER_YEAR;

  // Track the current week's box for "Go to Now"
  var currentWeekIdx = Math.floor((NOW - BIRTH) / MS_PER_WEEK);
  var nowBox = null;

  for (var w = 0; w < totalWeeks; w++) {
    var yearOfLife = Math.floor(w / WEEKS_PER_YEAR);
    var decade = Math.floor(yearOfLife / 10);
    var weekStart = new Date(BIRTH.getTime() + w * MS_PER_WEEK);
    var isFuture = weekStart > NOW;
    var isNow = (w === currentWeekIdx);

    // New decade section
    if (decade !== currentDecade) {
      currentDecade = decade;
      decadeDiv = document.createElement('div');
      decadeDiv.className = 'liw-decade';
      gridEl.appendChild(decadeDiv);
      createRow();
    }

    var evtsThisWeek = eventsByWeek[w];
    var decadeColors = DECADES[decade] || DECADES[DECADES.length - 1];

    // Build inline label
    var boxLabel = '';
    if (evtsThisWeek) {
      boxLabel = evtsThisWeek.map(function (e) { return e.label; }).join(' \u00b7 ');
    }

    // Check row space before inserting
    var units = boxUnits(boxLabel);
    ensureRowSpace(units);

    // Create box
    var box = document.createElement('button');
    box.type = 'button';
    box.className = 'liw-box' + (isFuture ? ' liw-future' : '') + (boxLabel ? ' liw-has-label' : '') + (isNow ? ' liw-now' : '');
    box.style.borderColor = decadeColors.border;
    if (!isFuture) {
      box.style.backgroundColor = decadeColors.fill;
    }

    if (isNow) {
      nowBox = box;
    }

    if (boxLabel) {
      box.textContent = boxLabel;
    }

    // Tooltip
    if (!isFuture) {
      var tip = document.createElement('span');
      tip.className = 'liw-tip';

      var dateDiv = document.createElement('div');
      dateDiv.className = 'liw-tip-date';
      dateDiv.textContent = fmtDate(weekStart);
      tip.appendChild(dateDiv);

      if (evtsThisWeek) {
        var labels = evtsThisWeek.map(function (e) { return e.label; });
        var labelDiv = document.createElement('div');
        labelDiv.className = 'liw-tip-label';
        labelDiv.textContent = labels.join(' \u00b7 ');
        tip.appendChild(labelDiv);

        // Show descriptions if any event has one
        var descs = evtsThisWeek.filter(function (e) { return e.description; });
        if (descs.length > 0) {
          var descDiv = document.createElement('div');
          descDiv.className = 'liw-tip-desc';
          descDiv.textContent = descs.map(function (e) { return e.description; }).join(' \u00b7 ');
          tip.appendChild(descDiv);
        }
      } else {
        var age = weekStart.getFullYear() - BIRTH.getFullYear();
        if (weekStart.getMonth() < BIRTH.getMonth() ||
            (weekStart.getMonth() === BIRTH.getMonth() && weekStart.getDate() < BIRTH.getDate())) {
          age--;
        }
        var ageDiv = document.createElement('div');
        ageDiv.className = 'liw-tip-label';
        ageDiv.textContent = 'Age ' + age;
        tip.appendChild(ageDiv);
      }

      if (isNow) {
        var nowDiv = document.createElement('div');
        nowDiv.className = 'liw-tip-label';
        nowDiv.style.fontWeight = 'bold';
        nowDiv.textContent = '\u2190 You are here';
        tip.appendChild(nowDiv);
      }

      box.appendChild(tip);
    }

    currentRow.appendChild(box);
    rowUnits += units;

    // Break after if row is full
    if (rowUnits >= MAX_BOXES_IN_ROW) {
      createRow();
    }
  }
  // Sticky legend: becomes sticky once scrolled past its natural position
  var legend = document.querySelector('.liw-legend');
  var legendTop = legend.offsetTop;
  window.addEventListener('scroll', function () {
    if (window.scrollY > legendTop) {
      legend.classList.add('liw-legend-sticky');
    } else {
      legend.classList.remove('liw-legend-sticky');
    }
  }, { passive: true });

  // "Go to Now" button - pulse animation with accent color
  document.getElementById('go-now').addEventListener('click', function () {
    if (!nowBox) return;
    nowBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // Brief pulse animation on arrival using design token color
    nowBox.style.transition = 'box-shadow 0.3s ease';
    setTimeout(function () {
      nowBox.style.boxShadow = '0 0 0 4px #D2691E, 0 0 20px rgba(210, 105, 30, 0.6)';
      setTimeout(function () {
        nowBox.style.boxShadow = '0 0 0 2px #D2691E, 0 0 12px rgba(210, 105, 30, 0.4)';
      }, 600);
    }, 500);
  });
})();
</script>
